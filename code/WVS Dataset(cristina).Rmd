---
title: "R Notebook"
output: html_notebook
---
Variables: 

Risk
Age 
Sex
Country


```{r}
library(data.table)
library(tidyr)
```

#read the data (Wave 5)
```{r}
# Data of Wave 5


WV5_data <- readRDS("/Users/cristinacandido/Documents/Github/risk_wvs/data/WVS/F00007944-WV5_Data_R_v20180912.rds")


# Convert WV5_data-object in data.frame 
WV5_data_df <- as.data.frame(WV5_data)

# show first five columns
head(WV5_data_df[, 1:5])
```

# clean the data set
```{r}
library(dplyr)

#rename the variables
WV5_data <- WV5_data_df %>%
  rename(sex = V235, age = V237, country = V2, wave = V1, risk = V86)
WV5_data


#select only the variables of interest
WV5_data <- WV5_data %>%
  select(sex, age, country, wave, risk)
WV5_data
```

```{r}
#decode the country names 
countrynames = read.csv("/Users/cristinacandido/Documents/Github/risk_wvs/data/WVS/countrynames.txt", header=FALSE,as.is=TRUE)
colnames(countrynames) = c("code", "name")
WV5_data$country_lab = countrynames$name [match(WV5_data$country, countrynames$code)]
table(WV5_data$country_lab)
WV5_data


```

#Read Dataset (Wave 6)
```{r}
WV6_data <- load("/Users/cristinacandido/Documents/Github/risk_wvs/data/WVS/WV6_Data_R_v20201117.rdata") 
WV6_data <- WV6_Data_R_v20201117 
print(WV6_data)
```

#rename variables
```{r}
WV6_data <- WV6_data %>%
  rename(wave = V1, sex = V240, age = V242,country = V2, risk = V76)


#select only the variables of interest
WV6_data <- WV6_data %>%
  select(wave, sex, age, country, sex,risk)
WV6_data

```


#decode daraset (Wave 6)
```{r}
countrynames = read.csv("/Users/cristinacandido/Documents/Github/risk_wvs/data/WVS/countrynames.txt", header=FALSE,as.is=TRUE)
colnames(countrynames) = c("code", "name")
WV6_data$country_lab = countrynames$name [match(WV6_data$country, countrynames$code)]
table(WV6_data$country_lab)
WV6_data
```

#combine the 2 dataset (Wave 6 + Wave 5)
```{r}
WV5_data
WV6_data
data = rbind(WV5_data, WV6_data)
data

#number of countries

length(unique(data$country_lab))
```
#exclusion of participants and omission of missing data (na)
```{r}
data = subset(data, risk > 0 & sex > 0 & age >0 )
data_Wave5 = subset(WV5_data, risk > 0 & sex > 0 & age >0 )
data_Wave6 = subset(WV6_data, risk > 0 & sex > 0 & age >0)
data <- na.omit(data)
data_Wave5 <- na.omit(data_Wave5)
data_Wave6 <- na.omit(data_Wave6)



#number of participants per Wave

nrow(data)
nrow(data_Wave5)
nrow(data_Wave6)
```
```{r}
# Load the dplyr package
library(dplyr)

# Assuming the data frame is called 'data' and the column containing the country information is called 'country'
country_counts <- data %>%
  count(country_lab)

# Print the result
print(country_counts)

```

#number and list and participants pro countries pro Wave (including both Waves together)
```{r}
table(data_Wave5$country_lab)
length(unique(data_Wave5$country_lab)) 
table(data_Wave6$country_lab)
length(unique(data_Wave6$country_lab))
length(unique(data$country_lab)) 
table(data$country_lab)
```


```{r}
# Transfrom risk item such that high values represent more risk taking
data$risk = 6 - data$risk + 1
# Risk item as ordinal variable 
data$risk_ord=data$risk 
  
# Transform risk variable into T-score (mean = 50, sd = 10)
data$risk = 10*scale(data$risk, center=TRUE,scale=TRUE)+50

data

```

#number of males vs females (1 = males; 2 = females)
```{r}
table(data$sex)
table(data_Wave5$sex)
table(data_Wave6$sex)
```


```{r}
#create a categorical age variable
data$agecat[data$age<20]="15-19"
data$agecat[data$age>=20 & data$age <30] = "20-29"
data$agecat[data$age>=30 & data$age <40] = "30-39"
data$agecat[data$age>=40 & data$age <50] = "40-49"
data$agecat[data$age>=50 & data$age <60] = "50-59"
data$agecat[data$age>=60 & data$age <70] = "60-69"
data$agecat[data$age>=70 & data$age <80] = "70-79"
data$agecat[data$age>=80] = "80+"
```


#gender variables
```{r}
data$sex[data$sex == 1] <- "male"
data$sex[data$sex == 2] <- "female"

data_Wave5$sex[data_Wave5$sex == 1] <- "male"
data_Wave5$sex[data_Wave5$sex == 2] <- "female"

data_Wave6$sex[data_Wave6$sex == 1] <- "male"
data_Wave6$sex[data_Wave6$sex == 2] <- "female"

#average age of participants
mean(data$age)
median(data$age)
```

#wave variables
```{r}
data$wave[data$wave == 5] <- "Wave 5"
data$wave[data$wave == 6] <- "Wave 6"
data
```


#age range
```{r}
range(data$age) 
range(data_Wave5$age)
range(data_Wave6$age)
```
#risk taking Frequency
```{r}
library(ggplot2)
ggplot(data, aes(x = risk)) +
  geom_histogram(binwidth = 0.5, fill = "lightblue", color = "black") +
  labs(x = "Risk Taking", y = "Frequency", title = "Histogram of Risk Taking") +
  theme_minimal()
```
#age frequency
```{r}
ggplot(data, aes(x = age)) +
  geom_histogram(binwidth = 0.5, fill = "lightblue", color = "black") +
  labs(x = "Age", y = "Frequency", title = "Histogram of Age Distributionn") +
  theme_minimal()
```
#age vs risk taking
```{r}

ggplot(data, aes(x = agecat, y = risk)) +
  geom_boxplot() +
  labs(title = "Boxplot of Risk and Adventure by Age",
       x = "Age",
       y = "Risk and Adventure") +
  theme_minimal()


```
#sex vs risk taking
```{r}
ggplot(data, aes(as.factor(sex), risk))+
  geom_boxplot()

```
```{r}
#descriptive data 
summary(data)
```
```{r}
#data cleaning: deletion of NAs 
data = na.omit(data)
summary(data)
```
```{r}
#risk distribution according to Waves 5 and 6 
ggplot(data, aes(as.factor(wave), risk))+
  geom_boxplot()
```
```{r}
#risk vs age
library(ggplot2)
ggplot(data, aes(risk, age))+
  geom_point()+
  geom_smooth(method = "lm")
```


```{r}
#selected 3 countries: Andorra, Romania, Spain
data1 <- subset(data, country_lab %in% c("Andorra", "Romania", "Spain"))
# 3 risk distribution for 3 countries
ggplot(data1, aes(as.factor(country_lab), risk))+
  geom_boxplot()
```
```{r}
#age vs risk depending on country
ggplot(data, aes(age, risk, color = as.factor(country_lab)))+
  geom_point()+
  geom_smooth(method = "lm", se = TRUE)
```
```{r}
```

```{r}
# read in file that contains hardship indicators manually collected from CIA factbook, WHO, and World Bank 
# (see Supplemental Materials for URL sources)
countryfacts = read.csv("/Users/cristinacandido/Documents/Github/risk_wvs/data/WVS/countryfacts_selection.csv", as.is = TRUE, header = TRUE) 

# Create a vector of labels with the same length as the number of columns in 'countryfacts'
labels <- c("code","country","codeWVS","Homicide","GDP","InfMort","LifeExp","GINI","GenderPEdu","code2")




# Print the result
print(countryfacts)
```

```{r}
# Load the dplyr package
library(dplyr)

# Assuming the data frame is called 'data' and the column containing the country information is called 'country'
age_counts <- data %>%
  count(agecat)

# Print the result
print(age_counts)
```
```{r}
summary(data)
```


```{r}

# Load the dplyr package
library(dplyr)


# Count the number of occurrences of each age category for each country
agepercountries_counts <- data %>%
  group_by(country_lab) %>%
  count(agecat)

# Print the result
print(agepercountries_counts)

```

```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

# Count the number of occurrences of each gender for each country
sexpercountries_counts <- data %>%
  group_by(country_lab) %>%
  count(sex)

# Print the result
print(sexpercountries_counts)

```
```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

# Group the data by country and calculate the age distribution
age_distribution_per_country <- data %>%
  group_by(country_lab) %>%
  summarize(mean_age = mean(age, na.rm = TRUE),
            median_age = median(age, na.rm = TRUE),
            min_age = min(age, na.rm = TRUE),
            max_age = max(age, na.rm = TRUE))

# Print the result
print(age_distribution_per_country)

```

```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

# Group the data by sex and calculate the mean risk for each sex
risk_by_sex <- data %>%
  group_by(sex) %>%
  summarize(mean_risk = mean(risk_ord, na.rm = TRUE))

# Calculate the difference in mean risk between sexes
sex_difference <- diff(risk_by_sex$mean_risk)

# Print the result
print(risk_by_sex)
print(sex_difference)


```
```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

# Group the data by country_lab and calculate the mean risk for each country_lab
risk_by_country_lab <- data %>%
  group_by(country_lab) %>%
  summarize(mean_risk = mean(risk_ord, na.rm = TRUE))

# Print the result
print(risk_by_country_lab)
```

```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}



# Group the data by age_cat and calculate the mean risk for each age category
risk_by_agecat <- data %>%
  group_by(agecat) %>%
  summarize(mean_risk = mean(risk_ord, na.rm = TRUE))

# Print the result
print(risk_by_agecat)

```


```{r}
data
```
```{r}
# Load the dplyr package if not already loaded
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

# Create the 'hardship' column in the 'countryfacts' data frame
countryfacts <- countryfacts %>%
  mutate(hardship = (homiciderate + gdp + infantmortality + lifeexpectancy + gini + femalemale_primedu) / 6)
countryfacts



# View the distribution of the 'hardship_index' column for each country
hardship_index_distribution <- countryfacts %>%
  group_by(label) %>%
  summarize(
    mean = mean(hardship, na.rm = TRUE),
    median = median(hardship, na.rm = TRUE),
    sd = sd(hardship, na.rm = TRUE),
    min = min(hardship, na.rm = TRUE),
    max = max(hardship, na.rm = TRUE),
    n = sum(!is.na(hardship))
  )

# Print the result
print(hardship_index_distribution)



  









```

```{r}
countryfacts
```
#Algeria 
```{r}
dataAlgeria <- subset(data, country_lab %in% c("Algeria"))
library(ggplot2)


pAlgeria <- ggplot(dataAlgeria, aes(x = z_age, y = risk, color = as.factor(sex))) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Scatterplot of risk_ord vs. age in Algeria", x = "Age", y = "Risk")

print(pAlgeria)


# Fit a linear model
modelAlgeria <- lm(risk ~ z_age * factor(sex), data = dataAlgeria)
summary(modelAlgeria)

# Extract coefficients
coefficients <- coef(modelAlgeria)

# Save the intercept and slope
intercept_Algeria <- coefficients[1]
slope_age_Algeria <- coefficients[2]
slope_gender_Algeria <- coefficients[3]

# Print the intercept and sloped
print(intercept_Algeria)
print(slope_age_Algeria)
print(slope_gender_Algeria)









```


```{r}
dataAlgeria
```
#Andorra
```{r}
dataAndorra <- subset(data, country_lab %in% c("Andorra"))
library(ggplot2)
PAndorra = ggplot(dataAndorra, aes(x = scale(age), risk_ord, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
PAndorra

modelAndorra<- lm(risk_ord ~ scale(age) * factor(sex), data = dataAndorra)
modelAndorra

coefficients <- coef(modelAndorra)

# Save the intercept and slopes
intercept_Andorra <- coefficients[1]
slope_age_Andorra <- coefficients[2]
slope_gender_Andorra <- coefficients[3]

# Print the intercept and slopes
print(intercept_Andorra)
print(slope_age_Andorra)
print(slope_gender_Andorra)


```
```{r}
library(dplyr)

library(dplyr)

library(dplyr)

table_data <- data %>%
  group_by(country_lab) %>%
  summarise(
    n = n(),
    female_percentage = mean(case_when(sex == 2 ~ 1, TRUE ~ 0)) * 100,  # Adjust encoding
    mean_age = mean(age, na.rm = TRUE),
    age_range = paste(min(age, na.rm = TRUE), "-", max(age, na.rm = TRUE)),
    mean_risk = mean(risk, na.rm = TRUE)
  )

table_data





```
#Argentina
```{r}
dataArgentina <- subset(data, country_lab %in% c("Argentina"))
library(ggplot2)
pArgentina = ggplot(dataArgentina, aes(x = z_age, risk, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pArgentina

ModelArgentina =  lm(risk ~ z_age + factor(sex), data = dataArgentina)
ModelArgentina


coefficients <- coef(ModelArgentina)

# Save the intercept and slopes
intercept_Argentina <- coefficients[1]
slope_age_Argentina <- coefficients[2]
slope_gender_Argentina <- coefficients[3]

# Print the intercept and slopes
print(intercept_Argentina)
print(slope_age_Argentina)
print(slope_gender_Argentina)

```
#Armenia
```{r}
dataArmenia <- subset(data, country_lab %in% c("Armenia"))
library(ggplot2)
pArmenia = ggplot(dataArmenia, aes(age, risk_ord, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pArmenia

```
#Australia
```{r}
dataAustralia <- subset(data, country_lab %in% c("Australia"))
library(ggplot2)
pAustralia = ggplot(dataAustralia, aes(z_age, risk, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pAustralia

ModelAustralia =  lm(risk ~ z_age + factor(sex), data = dataAustralia)
ModelAustralia


coefficients <- coef(ModelAustralia)

# Save the intercept and slopes
intercept_Australia <- coefficients[1]
slope_age_Australia <- coefficients[2]
slope_gender_Australia <- coefficients[3]

# Print the intercept and slopes
print(intercept_Australia)
print(slope_age_Australia)
print(slope_gender_Australia)


```
#Azerbaijan
```{r}
dataAzerbaijan <- subset(data, country_lab %in% c("Australia"))
library(ggplot2)
pAzerbaijan = ggplot(dataAzerbaijan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pAzerbaijan
```
#Belarus
```{r}
dataBelarus <- subset(data, country_lab %in% c("Belarus"))
library(ggplot2)
pBelarus = ggplot(dataBelarus, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pBelarus
```
#Brazil
```{r}
dataBrazil <- subset(data, country_lab %in% c("Brazil"))
library(ggplot2)
pBrazil = ggplot(dataBrazil, aes(z_age, risk, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pBrazil

ModelBrazil =  lm(risk ~ z_age + factor(sex), data = dataBrazil)
ModelBrazil


coefficients <- coef(ModelBrazil)

# Save the intercept and slopes
intercept_Brazil <- coefficients[1]
slope_age_Brazil <- coefficients[2]
slope_gender_Brazil <- coefficients[3]

# Print the intercept and slopes
print(intercept_Brazil)
print(slope_age_Brazil)
print(slope_gender_Brazil)



```
#Bulgaria
```{r}
dataBulgaria <- subset(data, country_lab %in% c("Bulgaria"))
library(ggplot2)
pBulgaria = ggplot(dataBulgaria, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pBulgaria



```
#Burkina Faso
```{r}
dataBurkinaFaso <- subset(data, country_lab %in% c("Burkina Faso"))
library(ggplot2)
pBurkinaFaso = ggplot(dataBurkinaFaso, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pBurkinaFaso
```
#Canada
```{r}
dataCanada <- subset(data, country_lab %in% c("Canada"))
library(ggplot2)
pCanada = ggplot(dataCanada, aes(z_age, risk, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pCanada

ModelCanada =  lm(risk ~ z_age + factor(sex), data = dataCanada)
ModelCanada


coefficients <- coef(ModelCanada)

# Save the intercept and slopes
intercept_Canada <- coefficients[1]
slope_age_Canada <- coefficients[2]
slope_gender_Canada <- coefficients[3]

# Print the intercept and slopes
print(intercept_Canada)
print(slope_age_Canada)
print(slope_gender_Canada)
```
#Chile
```{r}
dataChile <- subset(data, country_lab %in% c("Chile"))
library(ggplot2)
pChile = ggplot(dataChile, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pChile
```
#China
```{r}
dataChina <- subset(data, country_lab %in% c("China"))
library(ggplot2)
pChina = ggplot(dataChina, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pChina
```
#Colombia
```{r}
dataColombia <- subset(data, country_lab %in% c("Colombia "))
library(ggplot2)
pColombia  = ggplot(dataColombia, aes(z_age, risk, color = as.factor(sex)))+
  geom_point()+
  geom_smooth(method = "lm")
pColombia


ModelColombia =  lm(risk ~ z_age + as.factor(sex), data = dataColombia)
ModelColombia


coefficients <- coef(ModelColombia)

# Save the intercept and slopes
intercept_Colombia <- coefficients[1]
slope_age_Colombia <- coefficients[2]
slope_gender_Colombia <- coefficients[3]

# Print the intercept and slopes
print(intercept_Colombia)
print(slope_age_Colombia)
print(slope_gender_Colombia)



```
#Ecuador
```{r}
dataEcuador <- subset(data, country_lab %in% c("Ecuador"))
library(ggplot2)
pEcuador = ggplot(dataEcuador, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pEcuador
```
#Egypt
```{r}
dataEgypt <- subset(data, country_lab %in% c("Egypt"))
library(ggplot2)
pEgypt = ggplot(dataEgypt, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pEgypt
```
#Estonia
```{r}
dataEstonia <- subset(data, country_lab %in% c("Estonia"))
library(ggplot2)
pEstonia = ggplot(dataEstonia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pEstonia
```
#Ethiopia
```{r}
dataEthiopia <- subset(data, country_lab %in% c("Ethiopia"))
library(ggplot2)
pEthiopia = ggplot(dataEthiopia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pEthiopia
```
#Finland
```{r}
dataFinland <- subset(data, country_lab %in% c("Finland"))
library(ggplot2)
pFinland = ggplot(dataFinland, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pFinland
```
#France
```{r}
dataFrance <- subset(data, country_lab %in% c("France"))
library(ggplot2)
pFrance = ggplot(dataFrance, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pFrance
```

#Georgia
```{r}
dataGeorgia <- subset(data, country_lab %in% c("Georgia"))
library(ggplot2)
pGeorgia = ggplot(dataGeorgia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pGeorgia
```

#Germany
```{r}
dataGermany <- subset(data, country_lab %in% c("Germany"))
library(ggplot2)
pGermany = ggplot(dataGermany, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pGermany
```

#Ghana
```{r}
dataGhana <- subset(data, country_lab %in% c("Ghana"))
library(ggplot2)
pGhana = ggplot(dataGhana, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pGhana
```

#Great Britain
```{r}
dataUK <- subset(data, country_lab %in% c("Great Britain"))
library(ggplot2)
pUK = ggplot(dataUK, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pUK
```

#Haiti
```{r}
dataHaiti <- subset(data, country_lab %in% c("Haiti"))
library(ggplot2)
pHaiti = ggplot(dataHaiti, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pHaiti
```
#Hong Kong
```{r}
dataHongKong <- subset(data, country_lab %in% c("Hong Kong"))
library(ggplot2)
pHongKong = ggplot(dataHongKong, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pHongKong
```
#Hungary
```{r}
dataHungary <- subset(data, country_lab %in% c("Hungary"))
library(ggplot2)
pHungary = ggplot(dataHungary, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pHungary
```
#India
```{r}
dataIndia <- subset(data, country_lab %in% c("India"))
library(ggplot2)
pIndia = ggplot(dataIndia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pIndia
```
#Indonesia
```{r}
dataIndonesia <- subset(data, country_lab %in% c("Indonesia"))
library(ggplot2)
pIndonesia = ggplot(dataIndonesia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pIndonesia
```

#Iran
```{r}
dataIran <- subset(data, country_lab %in% c("Iran"))
library(ggplot2)
pIran = ggplot(dataIran, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pIran
```
#Iraq
```{r}
dataIraq <- subset(data, country_lab %in% c("Iraq"))
library(ggplot2)
pIraq = ggplot(dataIraq, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pIraq
```

#Japan
```{r}
dataJapan <- subset(data, country_lab %in% c("Japan"))
library(ggplot2)
pJapan = ggplot(dataJapan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pJapan
```

#Jordan
```{r}
dataJordan <- subset(data, country_lab %in% c("Jordan"))
library(ggplot2)
pJordan = ggplot(dataJordan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pJordan
```

#Kazakhstan
```{r}
dataKazakhstan <- subset(data, country_lab %in% c("Kazakhstan"))
library(ggplot2)
pKazakhstan = ggplot(dataKazakhstan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pKazakhstan
```
#Kuwait
```{r}
dataKuwait <- subset(data, country_lab %in% c("Kuwait"))
library(ggplot2)
pKuwait = ggplot(dataKuwait, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pKuwait
```
#Kyrgyzstan
```{r}
dataKyrgyzstan <- subset(data, country_lab %in% c("Kyrgyzstan"))
library(ggplot2)
pKyrgyzstan = ggplot(dataKyrgyzstan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pKyrgyzstan
```

#Lebanon
```{r}
dataLebanon <- subset(data, country_lab %in% c("Lebanon"))
library(ggplot2)
pLebanon = ggplot(dataLebanon, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pLebanon
```
#Libya
```{r}
dataLibya <- subset(data, country_lab %in% c("Libya"))
library(ggplot2)
pLibya = ggplot(dataLibya, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pLibya
```

#Malaysia
```{r}
dataMalaysia <- subset(data, country_lab %in% c("Malaysia"))
library(ggplot2)
pMalaysia = ggplot(dataMalaysia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pMalaysia
```
#Mali
```{r}
dataMali <- subset(data, country_lab %in% c("Mali"))
library(ggplot2)
pMali = ggplot(dataMali, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pMali
```

#Mexico
```{r}
dataMexico <- subset(data, country_lab %in% c("Mexico"))
library(ggplot2)
pMexico = ggplot(dataMexico, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pMexico
```
#Morocco
```{r}
dataMorocco <- subset(data, country_lab %in% c("Morocco"))
library(ggplot2)
pMorocco = ggplot(dataMorocco, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pMorocco
```
#Netherland
```{r}
dataNetherlands <- subset(data, country_lab %in% c("Netherlands"))
library(ggplot2)
pNetherlands = ggplot(dataNetherlands, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pNetherlands
```
#New Zealand
```{r}
dataNewZealand <- subset(data, country_lab %in% c("New Zealand"))
library(ggplot2)
pNewZealand = ggplot(dataNewZealand, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pNewZealand
```
#Nigeria
```{r}
dataNigeria <- subset(data, country_lab %in% c("Nigeria"))
library(ggplot2)
pNigeria = ggplot(dataNigeria, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pNigeria
```

#Norway 
```{r}
dataNorway <- subset(data, country_lab %in% c("Norway"))
library(ggplot2)
pNorway = ggplot(dataNorway, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pNorway
```
#Pakistan
```{r}
dataPakistan <- subset(data, country_lab %in% c("Pakistan"))
library(ggplot2)
pPakistan = ggplot(dataPakistan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pPakistan
```
#Palestine
```{r}
dataPalestine <- subset(data, country_lab %in% c("Palestine"))
library(ggplot2)
pPalestine = ggplot(dataPalestine, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pPalestine
```
#Peru
```{r}
dataPeru <- subset(data, country_lab %in% c("Peru"))
library(ggplot2)
pPeru = ggplot(dataPeru, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pPeru
```

#Philippines 
```{r}
dataPhilippines <- subset(data, country_lab %in% c("Philippines"))
library(ggplot2)
pPhilippines = ggplot(dataPhilippines, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pPhilippines
```

#Poland
```{r}
dataPoland <- subset(data, country_lab %in% c("Poland"))
library(ggplot2)
pPoland = ggplot(dataPoland, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pPoland
```
#Qatar
```{r}
dataQatar <- subset(data, country_lab %in% c("Qatar"))
library(ggplot2)
pQatar = ggplot(dataQatar, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pQatar
```
#Romania
```{r}
dataRomania <- subset(data, country_lab %in% c("Romania"))
library(ggplot2)
pRomania = ggplot(dataRomania, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pRomania
```
#Russia
```{r}
dataRussia <- subset(data, country_lab %in% c("Russia"))
library(ggplot2)
pRussia = ggplot(dataRussia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pRussia
```
#Rwanda
```{r}
dataRwanda <- subset(data, country_lab %in% c("Rwanda"))
library(ggplot2)
pRwanda = ggplot(dataRwanda, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pRwanda
```
#Singapore
```{r}
dataSingapore <- subset(data, country_lab %in% c("Singapore"))
library(ggplot2)
pSingapore = ggplot(dataSingapore, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSingapore
```
#Slovenia
```{r}
dataSlovenia <- subset(data, country_lab %in% c("Slovenia"))
library(ggplot2)
pSlovenia = ggplot(dataSlovenia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSlovenia
```
#South Africa
```{r}
dataSouthAfrica <- subset(data, country_lab %in% c("South Africa"))
library(ggplot2)
pSouthAfrica = ggplot(dataSouthAfrica, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSouthAfrica
```

#South Korea
```{r}
dataSouthKorea <- subset(data, country_lab %in% c("South Korea"))
library(ggplot2)
pSouthKorea = ggplot(dataSouthKorea, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSouthKorea
```
#Spain
```{r}
dataSpain <- subset(data, country_lab %in% c("Spain"))
library(ggplot2)
pSpain = ggplot(dataSpain, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSpain
```
#Sweden
```{r}
dataSweden <- subset(data, country_lab %in% c("Sweden"))
library(ggplot2)
pSweden = ggplot(dataSweden, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSweden
```
#Switzerland 
```{r}
dataSwitzerland <- subset(data, country_lab %in% c("Switzerland"))
library(ggplot2)
pSwitzerland = ggplot(dataSwitzerland, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pSwitzerland
```
#Taiwan
```{r}
dataTaiwan <- subset(data, country_lab %in% c("Taiwan"))
library(ggplot2)
pTaiwan = ggplot(dataTaiwan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pTaiwan
```

#Thailand
```{r}
dataThailand <- subset(data, country_lab %in% c("Thailand"))
library(ggplot2)
pThailand = ggplot(dataThailand, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pThailand
```

#Trinidad and Tobago
```{r}
dataTrinidad <- subset(data, country_lab %in% c("Trinidad and Tobago"))
library(ggplot2)
pTrinidad = ggplot(dataTrinidad, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pTrinidad
```

#Tunisia
```{r}
dataTunisia<- subset(data, country_lab %in% c("Tunisia"))
library(ggplot2)
pTunisia = ggplot(dataTunisia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pTunisia
```

#Turkey
```{r}
dataTurkey <- subset(data, country_lab %in% c("Turkey"))
library(ggplot2)
pTurkey = ggplot(dataTurkey, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pTurkey
```

#Ukraine
```{r}
dataUkraine <- subset(data, country_lab %in% c("Ukraine"))
library(ggplot2)
pUkraine = ggplot(dataUkraine, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pUkraine
```

#United States
```{r}
dataUS <- subset(data, country_lab %in% c("United States"))
library(ggplot2)
pUS = ggplot(dataUS, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pUS
```

#Uruguay
```{r}
dataUruguay <- subset(data, country_lab %in% c("Uruguay"))
library(ggplot2)
pUruguay = ggplot(dataUruguay, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pUruguay
```

#Uzbekistan
```{r}
dataUzbekistan <- subset(data, country_lab %in% c("Uzbekistan"))
library(ggplot2)
pUzbekistan = ggplot(dataUzbekistan, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pUzbekistan
```

#Viet Nam
```{r}
dataVietNam <- subset(data, country_lab %in% c("Viet Nam"))
library(ggplot2)
pVietNam = ggplot(dataVietNam, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pVietNam
```

#Yemen
```{r}
dataYemen <- subset(data, country_lab %in% c("Yemen"))
library(ggplot2)
pYemen = ggplot(dataYemen, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pYemen
```

#Zambia
```{r}
dataZambia <- subset(data, country_lab %in% c("Zambia"))
library(ggplot2)
pZambia = ggplot(dataZambia, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pZambia
```

#Zimbabwe 
```{r}
dataZimbabwe <- subset(data, country_lab %in% c("Zimbabwe"))
library(ggplot2)
pZimbabwe = ggplot(dataZimbabwe, aes(age, risk_ord))+
  geom_point()+
  geom_smooth(method = "lm")
pZimbabwe
```

```{r}
#summarise the countries
# Assuming your original data frame has uppercase variable names (Age and Risk)

means_data <- data %>%
  group_by(country_lab) %>%
  summarise(
    Mean_Age = mean(age),
    Mean_Risk = mean(risk_ord))
    
    
  

means_data

```
```{r}
countryfacts

```
```{r}
gdp_data <- countryfacts %>%
  select(, label, code, gdp)
gdp_data

```
```{r}
library(ggplot2)

# Assuming 'data' is your data frame with a column 'age'
data$z_age <- scale(data$age)

ggplot(data, aes(z_age, risk, color = factor(sex))) +
  geom_point(size = 0.1) +  
  geom_smooth(method = "lm") +
  scale_color_manual(values = c("blue", "red"), labels = c("Male", "Female")) +
  labs(color = "Gender", x = "Age", y = "Risk Taking") +
  theme_minimal()
Model1 <- lm(risk ~ scale(age) * factor(sex), data = data)
Model1
```
```{r}
data
```



```{r}
table_data <- data %>%
  group_by(country_lab) %>%
  summarize(
    n = n(),
    female_percentage = mean(sex == 1) * 100,
    mean_age = mean(age, na.rm = TRUE),
    age_range = paste(min(age, na.rm = TRUE), "-", max(age, na.rm = TRUE)),
    mean_risk = mean(risk, na.rm = TRUE)
  )

table_data






```

```{r}
regression_results <- data %>%
  group_by(country_lab) %>%
  do(model = lm(risk ~ age + sex, data = .)) %>%
  summarize(
    country = first(country_lab),
    intercept = coef(summary(model))[1, 1],
    slope_age = coef(summary(model))[2, 1],
    slope_gender = coef(summary(model))[3, 1]
  )

regression_results

write.csv(regression_results, "/Users/cristinacandido/Documents/Github/risk_wvs/regression_results.csv", row.names = FALSE)
```





















